# è¾“å‡ºç”Ÿæˆè®¾è®¡æ–‡æ¡£

## æ¦‚è¿°

æœ¬æ–‡æ¡£æè¿° LLM Excel ç³»ç»Ÿçš„è¾“å‡ºç”Ÿæˆæ¨¡å—è®¾è®¡ã€‚è¯¥æ¨¡å—è´Ÿè´£å°†æ‰§è¡Œç»“æœè½¬æ¢ä¸ºç”¨æˆ·å‹å¥½çš„ä¸¤ç§è¾“å‡ºæ ¼å¼ï¼š

1. **æ€è·¯è§£è¯»**ï¼ˆStrategy Explanationï¼‰ï¼šè®©ç”¨æˆ·ç†è§£ç³»ç»Ÿ"å‡†å¤‡æ€ä¹ˆæ“ä½œ"
2. **å¿«æ·å¤ç°**ï¼ˆManual Stepsï¼‰ï¼šç”¨æˆ·æ‰‹åŠ¨æ“ä½œ Excel çš„æ­¥éª¤æŒ‡å—

## è®¾è®¡ç›®æ ‡

### æ ¸å¿ƒä»·å€¼

> **è®©ç”¨æˆ·èƒ½éªŒè¯ç³»ç»Ÿçš„æ€è·¯æ˜¯å¦æ­£ç¡®ï¼Œæ€è·¯å¯¹åˆ™ç»“æœå¯ä¿¡ä»»ã€‚**

è¿™æ˜¯æœ¬ç³»ç»Ÿç›¸æ¯”å…¶ä»–æŠ€æœ¯æ–¹æ¡ˆçš„æ ¸å¿ƒä¼˜åŠ¿ã€‚

### ç›®æ ‡ç”¨æˆ·

- æ‡‚ Excel æ“ä½œçš„ä¸šåŠ¡äººå‘˜
- æ—¥å¸¸å·¥ä½œæ˜¯æ ¹æ®éœ€æ±‚å¤„ç† Excel è¡¨æ ¼
- éœ€è¦èƒ½çœ‹æ‡‚ç³»ç»Ÿçš„å¤„ç†é€»è¾‘ï¼Œåˆ¤æ–­æ˜¯å¦æ­£ç¡®

### ä¸¤ç§è¾“å‡ºçš„å®šä½

| è¾“å‡º         | é¢å‘äººç¾¤         | ç›®çš„             | å†…å®¹                              |
| ------------ | ---------------- | ---------------- | --------------------------------- |
| **æ€è·¯è§£è¯»** | æ‰€æœ‰ç”¨æˆ·         | éªŒè¯æ€è·¯æ˜¯å¦æ­£ç¡® | åšä»€ä¹ˆ + æ€ä¹ˆåšï¼ˆæ¦‚è¦ï¼‰           |
| **å¿«æ·å¤ç°** | æƒ³æ‰‹åŠ¨æ“ä½œçš„ç”¨æˆ· | åœ¨ Excel ä¸­å¤ç°  | å…·ä½“æ“ä½œæ­¥éª¤ï¼ˆå« Excel 365 å…¬å¼ï¼‰ |

---

## æ•°æ®æµè®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  LLM Generate       â”‚
â”‚  operations +       â”‚
â”‚  description        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Execute Stage      â”‚
â”‚  æ‰§è¡Œæ“ä½œ            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Output Generator                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  generate_strategy()     â†’ æ€è·¯è§£è¯»              â”‚
â”‚  generate_manual_steps() â†’ å¿«æ·å¤ç°              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ProcessResult     â”‚
â”‚   - strategy        â”‚
â”‚   - manual_steps    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## è¾“å‡ºæ ¼å¼è®¾è®¡

### 1. æ€è·¯è§£è¯»ï¼ˆStrategy Explanationï¼‰

#### è®¾è®¡åŸåˆ™

- **å†…å®¹æ¥æº**ï¼š
  - `description`ï¼šLLM ç”Ÿæˆï¼Œæè¿°"åšä»€ä¹ˆ"ï¼ˆè¯­ä¹‰å±‚é¢ï¼‰
  - æŠ€æœ¯ç»†èŠ‚ï¼šç³»ç»Ÿä» operation ç»“æ„è§£æï¼Œæè¿°"æ€ä¹ˆåš"

- **è¯¦ç»†ç¨‹åº¦**ï¼šä¸­ç­‰ï¼Œè®©ç”¨æˆ·èƒ½å¿«é€Ÿç†è§£æ•´ä½“æ€è·¯

#### è¾“å‡ºæ ¼å¼

```
ğŸ“‹ å¤„ç†æ€è·¯

æœ¬æ¬¡å¤„ç†å…± {N} æ­¥ï¼š

æ­¥éª¤ 1ï¼š{description}
â”œâ”€ æ“ä½œï¼š{æ“ä½œç±»å‹ä¸­æ–‡å}
â”œâ”€ ç›®æ ‡ï¼š{filename} / {sheet_name}
â”œâ”€ {æ¡ä»¶/å…¬å¼/åˆ†ç»„ç­‰ç»†èŠ‚}
â””â”€ æ–¹æ³•ï¼š{ä½¿ç”¨çš„å‡½æ•°æˆ–æ“ä½œ}

æ­¥éª¤ 2ï¼š{description}
â”œâ”€ æ“ä½œï¼š{æ“ä½œç±»å‹ä¸­æ–‡å}
â”œâ”€ ç›®æ ‡ï¼š{filename} / {sheet_name}ï¼ˆç”±æ­¥éª¤ 1 åˆ›å»ºï¼‰
â””â”€ æ–¹æ³•ï¼š{ä½¿ç”¨çš„å‡½æ•°æˆ–æ“ä½œ}

â†’ æœ€ç»ˆç»“æœï¼š{è¾“å‡ºæè¿°}
```

#### ç¤ºä¾‹

éœ€æ±‚ï¼šåœ¨æ³°å¦å°¼å…‹æ•°æ®ä¸­ï¼Œæ‰¾å‡ºç”Ÿè¿˜çš„å¥³æ€§ä¹˜å®¢ï¼ŒæŒ‰å¹´é¾„é™åºæ’åˆ—ï¼Œå–å‰10å

```
ğŸ“‹ å¤„ç†æ€è·¯

æœ¬æ¬¡å¤„ç†å…± 3 æ­¥ï¼š

æ­¥éª¤ 1ï¼šç­›é€‰å‡ºç”Ÿè¿˜çš„å¥³æ€§ä¹˜å®¢
â”œâ”€ æ“ä½œï¼šç­›é€‰æ•°æ®
â”œâ”€ ç›®æ ‡ï¼štitanic.xlsx / train
â”œâ”€ æ¡ä»¶ï¼šSex = "female" ä¸” Survived = 1
â””â”€ æ–¹æ³•ï¼šFILTER å‡½æ•°ï¼ˆå¤šæ¡ä»¶ AND ç­›é€‰ï¼‰

æ­¥éª¤ 2ï¼šæŒ‰å¹´é¾„ä»å¤§åˆ°å°æ’åº
â”œâ”€ æ“ä½œï¼šæ’åº
â”œâ”€ ç›®æ ‡ï¼štitanic.xlsx / ç”Ÿè¿˜å¥³æ€§ï¼ˆæ­¥éª¤ 1 åˆ›å»ºï¼‰
â””â”€ æ–¹æ³•ï¼šSORT å‡½æ•°ï¼ˆé™åºï¼‰

æ­¥éª¤ 3ï¼šåªä¿ç•™å‰ 10 è¡Œ
â”œâ”€ æ“ä½œï¼šå–å‰ N è¡Œ
â”œâ”€ ç›®æ ‡ï¼štitanic.xlsx / ç”Ÿè¿˜å¥³æ€§
â””â”€ æ–¹æ³•ï¼šTAKE å‡½æ•°

â†’ æœ€ç»ˆç»“æœï¼šæ–°å·¥ä½œè¡¨ã€Œç”Ÿè¿˜å¥³æ€§ã€ï¼ŒåŒ…å«å¹´é¾„æœ€å¤§çš„ 10 ä½ç”Ÿè¿˜å¥³æ€§
```

---

### 2. å¿«æ·å¤ç°ï¼ˆManual Stepsï¼‰

#### è®¾è®¡åŸåˆ™

- **Excel ç‰ˆæœ¬é€‚é…**ï¼š
  - é«˜çº§æ“ä½œï¼ˆfilter, sort, group_by, takeï¼‰ï¼šåŒæ—¶æä¾›é 365 å’Œ 365 ä¸¤ç§æ–¹å¼
  - åŸºç¡€æ“ä½œï¼ˆadd_column, aggregate ç­‰ï¼‰ï¼šå…¬å¼æ–¹å¼ï¼Œç‰ˆæœ¬é€šç”¨

- **ä¼˜å…ˆçº§**ï¼šé 365 æ–¹å¼ä¼˜å…ˆå±•ç¤ºï¼ˆå¤§éƒ¨åˆ†ç”¨æˆ·ä½¿ç”¨é 365 ç‰ˆæœ¬ï¼‰

- **å†…å®¹**ï¼šå…·ä½“çš„èœå•æ“ä½œæ­¥éª¤ï¼Œé¢å‘å®é™…æ“ä½œ

#### æ“ä½œç±»å‹åˆ†ç±»

| æ“ä½œç±»å‹        | åˆ†ç±» | é 365 æ–¹å¼  | 365 æ–¹å¼           |
| --------------- | ---- | ------------ | ------------------ |
| `add_column`    | åŸºç¡€ | å…¬å¼         | å…¬å¼ï¼ˆç›¸åŒï¼‰       |
| `update_column` | åŸºç¡€ | å…¬å¼         | å…¬å¼ï¼ˆç›¸åŒï¼‰       |
| `aggregate`     | åŸºç¡€ | å…¬å¼         | å…¬å¼ï¼ˆç›¸åŒï¼‰       |
| `compute`       | åŸºç¡€ | å…¬å¼         | å…¬å¼ï¼ˆç›¸åŒï¼‰       |
| `filter`        | é«˜çº§ | æ•°æ®ç­›é€‰åŠŸèƒ½ | FILTER å‡½æ•°        |
| `sort`          | é«˜çº§ | æ’åºåŠŸèƒ½     | SORT å‡½æ•°          |
| `group_by`      | é«˜çº§ | æ•°æ®é€è§†è¡¨   | GROUPBY å‡½æ•°       |
| `take`          | é«˜çº§ | æ‰‹åŠ¨åˆ é™¤è¡Œ   | TAKE å‡½æ•°          |
| `create_sheet`  | å†…éƒ¨ | æ–°å»ºå·¥ä½œè¡¨   | æ–°å»ºå·¥ä½œè¡¨ï¼ˆç›¸åŒï¼‰ |

#### è¾“å‡ºæ ¼å¼

```
ğŸ”§ æ‰‹åŠ¨æ“ä½œæ­¥éª¤

æ­¥éª¤ 1ï¼š{æ“ä½œæ ‡é¢˜}
   {å…·ä½“æ“ä½œæŒ‡å¼•}

æ­¥éª¤ 2ï¼š{æ“ä½œæ ‡é¢˜}
   {å…·ä½“æ“ä½œæŒ‡å¼•}

---
ğŸ’¡ Excel 365 ç”¨æˆ·æç¤º
å¦‚æœä½ ä½¿ç”¨ Excel 365ï¼Œå¯ä»¥ç”¨å…¬å¼æ›¿ä»£éƒ¨åˆ†æ“ä½œï¼š
{é«˜çº§æ“ä½œçš„å…¬å¼æ–¹å¼}
```

#### ç¤ºä¾‹

```
ğŸ”§ æ‰‹åŠ¨æ“ä½œæ­¥éª¤

æ­¥éª¤ 1ï¼šç­›é€‰æ•°æ®
   1. æ‰“å¼€ titanic.xlsxï¼Œåˆ‡æ¢åˆ° train å·¥ä½œè¡¨
   2. é€‰ä¸­æ•°æ®åŒºåŸŸï¼ˆåŒ…å«è¡¨å¤´ï¼‰
   3. ç‚¹å‡»ã€Œæ•°æ®ã€â†’ã€Œç­›é€‰ã€
   4. åœ¨ Sex åˆ—ä¸‹æ‹‰èœå•ä¸­ï¼Œåªå‹¾é€‰ "female"
   5. åœ¨ Survived åˆ—ä¸‹æ‹‰èœå•ä¸­ï¼Œåªå‹¾é€‰ "1"
   6. é€‰ä¸­ç­›é€‰åçš„æ‰€æœ‰æ•°æ®ï¼ˆåŒ…å«è¡¨å¤´ï¼‰ï¼ŒæŒ‰ Ctrl+C å¤åˆ¶
   7. æ–°å»ºå·¥ä½œè¡¨ï¼Œå‘½åä¸ºã€Œç”Ÿè¿˜å¥³æ€§ã€
   8. åœ¨ A1 å•å…ƒæ ¼æŒ‰ Ctrl+V ç²˜è´´
   9. è¿”å› train å·¥ä½œè¡¨ï¼Œç‚¹å‡»ã€Œæ•°æ®ã€â†’ã€Œç­›é€‰ã€å–æ¶ˆç­›é€‰

æ­¥éª¤ 2ï¼šæ’åº
   1. åˆ‡æ¢åˆ°ã€Œç”Ÿè¿˜å¥³æ€§ã€å·¥ä½œè¡¨
   2. é€‰ä¸­æ‰€æœ‰æ•°æ®ï¼ˆåŒ…å«è¡¨å¤´ï¼‰
   3. ç‚¹å‡»ã€Œæ•°æ®ã€â†’ã€Œæ’åºã€
   4. ä¸»è¦å…³é”®å­—é€‰æ‹©ã€ŒAgeã€ï¼Œæ’åºä¾æ®é€‰æ‹©ã€Œæ•°å€¼ã€ï¼Œæ¬¡åºé€‰æ‹©ã€Œé™åºã€
   5. ç‚¹å‡»ã€Œç¡®å®šã€

æ­¥éª¤ 3ï¼šä¿ç•™å‰ 10 è¡Œ
   1. ç‚¹å‡»ç¬¬ 12 è¡Œçš„è¡Œå·
   2. æŒ‰ä½ Shiftï¼Œæ»šåŠ¨åˆ°æœ€åä¸€è¡Œæ•°æ®ï¼Œç‚¹å‡»è¯¥è¡Œå·ï¼ˆé€‰ä¸­æ‰€æœ‰å¤šä½™è¡Œï¼‰
   3. å³é”® â†’ã€Œåˆ é™¤ã€

---
ğŸ’¡ Excel 365 ç”¨æˆ·æç¤º
å¦‚æœä½ ä½¿ç”¨ Excel 365ï¼Œå¯ä»¥ç”¨ä»¥ä¸‹å…¬å¼ä¸€æ­¥å®Œæˆï¼š

åœ¨æ–°å·¥ä½œè¡¨çš„ A1 å•å…ƒæ ¼è¾“å…¥ï¼š
=TAKE(SORT(FILTER(train!A:L, (train!E:E="female")*(train!B:B=1)), 6, -1), 10)

å…¬å¼è¯´æ˜ï¼š
â€¢ FILTER(...) - ç­›é€‰ Sex="female" ä¸” Survived=1 çš„è¡Œ
â€¢ SORT(..., 6, -1) - æŒ‰ç¬¬ 6 åˆ—ï¼ˆAgeï¼‰é™åºæ’åº
â€¢ TAKE(..., 10) - å–å‰ 10 è¡Œ
```

---

## å®ç°è®¾è®¡

### æ•°æ®ç»“æ„å˜æ›´

#### ProcessResult å­—æ®µ

```python
@dataclass
class ProcessResult:
    # å„é˜¶æ®µè¾“å‡º
    analysis: Optional[str] = None
    operations: Optional[List] = None     # æ“ä½œåˆ—è¡¨ï¼ˆJSON åºåˆ—åŒ–åçš„æ“ä½œå¯¹è±¡ï¼‰
    strategy: Optional[str] = None        # æ€è·¯è§£è¯»
    manual_steps: Optional[str] = None    # å¿«æ·å¤ç°

    # æ‰§è¡Œç»“æœ
    variables: Dict[str, Any] = field(default_factory=dict)
    new_columns: Dict[str, Dict[str, Dict[str, List]]] = field(default_factory=dict)
    updated_columns: Dict[str, Dict[str, Dict[str, List]]] = field(default_factory=dict)
    new_sheets: Dict[str, Dict[str, Dict]] = field(default_factory=dict)
    modified_tables: Optional["FileCollection"] = None
    errors: List[str] = field(default_factory=list)
```

### æ–°æ¨¡å—ï¼šoutput_generator.py

```python
# apps/api/app/engine/output_generator.py

def generate_strategy(operations: List, tables: FileCollection) -> str:
    """
    ç”Ÿæˆæ€è·¯è§£è¯»

    Args:
        operations: æ“ä½œåˆ—è¡¨ï¼ˆåŒ…å« descriptionï¼‰
        tables: æ–‡ä»¶é›†åˆï¼ˆç”¨äºè·å–æ–‡ä»¶åï¼‰

    Returns:
        æ€è·¯è§£è¯»æ–‡æœ¬
    """

def generate_manual_steps(operations: List, tables: FileCollection) -> str:
    """
    ç”Ÿæˆå¿«æ·å¤ç°æ­¥éª¤

    Args:
        operations: æ“ä½œåˆ—è¡¨
        tables: æ–‡ä»¶é›†åˆ

    Returns:
        æ‰‹åŠ¨æ“ä½œæ­¥éª¤æ–‡æœ¬
    """

def _get_operation_type_name(op_type: str) -> str:
    """è·å–æ“ä½œç±»å‹çš„ä¸­æ–‡å"""

def _extract_method_from_operation(op) -> str:
    """ä»æ“ä½œä¸­æå–ä½¿ç”¨çš„æ–¹æ³•/å‡½æ•°"""

def _generate_filter_manual_steps(op, tables, step_num) -> str:
    """ç”Ÿæˆ filter æ“ä½œçš„æ‰‹åŠ¨æ­¥éª¤"""

def _generate_sort_manual_steps(op, tables, step_num) -> str:
    """ç”Ÿæˆ sort æ“ä½œçš„æ‰‹åŠ¨æ­¥éª¤"""

# ... å…¶ä»–æ“ä½œç±»å‹çš„æ­¥éª¤ç”Ÿæˆå‡½æ•°
```

### æ“ä½œç±»å‹æ˜ å°„è¡¨

```python
OPERATION_TYPE_NAMES = {
    "aggregate": "èšåˆè®¡ç®—",
    "add_column": "æ–°å¢åˆ—",
    "update_column": "æ›´æ–°åˆ—",
    "compute": "æ ‡é‡è®¡ç®—",
    "filter": "ç­›é€‰æ•°æ®",
    "sort": "æ’åº",
    "group_by": "åˆ†ç»„ç»Ÿè®¡",
    "take": "å–å‰/å N è¡Œ",
    "create_sheet": "åˆ›å»ºå·¥ä½œè¡¨",
}

# é«˜çº§æ“ä½œï¼ˆéœ€è¦åŒºåˆ† 365 / é 365ï¼‰
ADVANCED_OPERATIONS = {"filter", "sort", "group_by", "take"}
```

### é›†æˆä½ç½®

åœ¨ `ExecuteStage` å®Œæˆåï¼Œè°ƒç”¨è¾“å‡ºç”Ÿæˆå‡½æ•°ï¼š

```python
# apps/api/app/processor/stages/execute.py

from app.engine.output_generator import generate_strategy, generate_manual_steps

class ExecuteStage:
    def run(self, ...):
        # ... æ‰§è¡Œæ“ä½œ ...

        # ç”Ÿæˆè¾“å‡º
        strategy = generate_strategy(operations, tables)
        manual_steps = generate_manual_steps(operations, tables)

        return {
            "strategy": strategy,
            "manual_steps": manual_steps,
            # ... å…¶ä»–å­—æ®µ ...
        }
```

---

## description å­—æ®µè§„èŒƒ

### è®¾è®¡åŸåˆ™

é‡‡ç”¨**åˆ†å·¥åˆä½œ**æ¨¡å¼ï¼š

- **LLM è´Ÿè´£**ï¼šç”Ÿæˆè‡ªç„¶è¯­è¨€æè¿°ï¼Œè¯´æ˜è¿™ä¸€æ­¥çš„**ç›®çš„**
- **ç³»ç»Ÿè´Ÿè´£**ï¼šä»æ“ä½œç»“æ„ä¸­è§£æ**æŠ€æœ¯ç»†èŠ‚**ï¼ˆæ¡ä»¶ã€å‡½æ•°ã€å…¬å¼ç­‰ï¼‰

### Prompt è¦æ±‚

```
**é‡è¦**ï¼šæ¯ä¸ªæ“ä½œéƒ½å¿…é¡»åŒ…å« `description` å­—æ®µï¼Œç”¨è‡ªç„¶è¯­è¨€æè¿°è¿™ä¸€æ­¥æ“ä½œçš„ç›®çš„ã€‚
- æè¿°åº”è¯´æ˜"åšä»€ä¹ˆ"ï¼Œè€Œä¸æ˜¯"æ€ä¹ˆåš"
- é•¿åº¦æ§åˆ¶åœ¨ 1-2 å¥è¯
- å¯ä»¥åŒ…å«å…³é”®çš„ä¸šåŠ¡è¯­ä¹‰ï¼ˆå¦‚"ç”Ÿè¿˜çš„å¥³æ€§"è€Œä¸æ˜¯"Survived=1 ä¸” Sex=female"ï¼‰
```

### ç¤ºä¾‹

| æ“ä½œç±»å‹   | description ç¤ºä¾‹              |
| ---------- | ----------------------------- |
| filter     | "ç­›é€‰å‡ºç”Ÿè¿˜çš„å¥³æ€§ä¹˜å®¢"        |
| sort       | "æŒ‰å¹´é¾„ä»å¤§åˆ°å°æ’åº"          |
| add_column | "è®¡ç®—æ¯ä»¶å•†å“æ‰“ 9 æŠ˜åçš„ä»·æ ¼" |
| group_by   | "æŒ‰èˆ¹èˆ±ç­‰çº§ç»Ÿè®¡å¹³å‡ç¥¨ä»·"      |
| aggregate  | "è®¡ç®—æ‰€æœ‰ä¹˜å®¢çš„å¹³å‡å¹´é¾„"      |

---

## æ–‡ä»¶ç»“æ„

```
apps/api/app/engine/
â”œâ”€â”€ output_generator.py    # è¾“å‡ºç”Ÿæˆå™¨ï¼ˆæ€è·¯è§£è¯» + å¿«æ·å¤ç°ï¼‰
â”œâ”€â”€ excel_generator.py     # Excel å…¬å¼ç”Ÿæˆå™¨ï¼ˆä¾› output_generator ä½¿ç”¨ï¼‰
â”œâ”€â”€ ...
```

---

## æ³¨æ„äº‹é¡¹

### å¼‚å¸¸å¤„ç†

`generate_strategy()` å’Œ `generate_manual_steps()` åœ¨ `execute.py` ä¸­åˆ†åˆ«ç”¨ç‹¬ç«‹çš„ try å—è°ƒç”¨ï¼Œç¡®ä¿ä¸€ä¸ªå¤±è´¥ä¸å½±å“å¦ä¸€ä¸ªã€‚

### æ“ä½œå¯¹è±¡å±æ€§

- `ComputeOperation` ä½¿ç”¨ `expression` å­—æ®µï¼ˆä¸æ˜¯ `formula`ï¼‰
- `AggregateOperation` ä½¿ç”¨ `as_var` å­—æ®µå­˜å‚¨å˜é‡å

---

## æ›´æ–°æ—¥å¿—

- **2026-02-03**ï¼šå®ç°å®Œå–„
  - ç§»é™¤ formulas å­—æ®µï¼ˆExcel å…¬å¼å¤ç°ï¼‰ï¼Œåˆå¹¶åˆ° manual_steps ä¸­
  - ä¿®å¤ ComputeOperation å±æ€§åï¼ˆexpressionï¼Œé formulaï¼‰
  - åˆ†ç¦» strategy å’Œ manual_steps çš„å¼‚å¸¸å¤„ç†
  - operations å­˜å‚¨ä¸ºåˆ—è¡¨æ ¼å¼

- **2026-02-02**ï¼šåˆå§‹è®¾è®¡
  - æ–°å¢æ€è·¯è§£è¯»ï¼ˆstrategyï¼‰è¾“å‡º
  - æ–°å¢å¿«æ·å¤ç°ï¼ˆmanual_stepsï¼‰è¾“å‡º
  - é«˜çº§æ“ä½œæ”¯æŒ 365 / é 365 ä¸¤ç§å¤ç°æ–¹å¼
